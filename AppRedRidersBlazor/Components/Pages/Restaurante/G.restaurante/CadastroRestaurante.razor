@page "/CadastroRestaurante"
@rendermode InteractiveServer
@using AppRedRidersBlazor.Models;
@inject RestauranteDAO restauranteDAO
@inject NavigationManager Navigation;


<PageTitle>Cadastro Restaurante</PageTitle>
<main>
    <div class="nav-controller">
        <div id="navbar-restaurante" style="display: flex"></div>
    </div>

    <!-- outlet-->
    <div id="cadastrar-restaurant-container">
        <h2 class="cadastrar-restaurant-title">Cadastrar Restaurante</h2>

        <EditForm Model="_novoRestaurante" OnValidSubmit="Salvar">
            <div class="cadastrar-restaurant-field">
                <label for="restaurant-name">Nome:</label>
                <input @bind="@_novoRestaurante!.nome" id="restaurant-name" type="text" name="name" required />
            </div>

            <div class="cadastrar-restaurant-field">
                <label for="restaurant-number">Telefone:</label>
                <input @bind-value="_novoRestaurante!.Telefone" id="restaurant-number" type="text" name="number" required />
            </div>

            <div class="cadastrar-restaurant-field">
                <label for="restaurant-address">Endereço:</label>
                <input @bind-value="_novoRestaurante!.endereco" id="restaurant-address" type="text" name="address" required />
            </div>

            <div class="cadastrar-restaurant-field">
                <label for="restaurant-cnpj">CNPJ:</label>
                <input @bind-value="_novoRestaurante!.CNPJ" id="restaurant-cnpj" type="text" name="cnpj" required />
            </div>

            <div class="cadastrar-restaurant-field">
                <label for="restaurant-img">Link da imagem:</label>
                <input @bind-value="_novoRestaurante!.imagem" id="restaurant-img" type="text" name="img" required />
            </div>

         <button type="submit" class="btn-salvar">Cadastrar</button>

            @if (erro is not null)
            {
                <p style="color:red">@erro</p>
            }
        </EditForm>
    </div>
</main>
@code {
    private string? erro = null;

    [SupplyParameterFromForm]
    private Restaurante? _novoRestaurante { get; set; } = new();

    private void Salvar()
    {

        try
        {
            if (_novoRestaurante.nome is null || _novoRestaurante.nome == "")
            {
                throw new Exception("O campo nome é obrigatório");
            }

            restauranteDAO.Inserir(_novoRestaurante);

            Navigation.NavigateTo("/MainRestaurante");
        }
        catch (Exception ex)
        {
            erro = ex.Message;
        }


    }
}