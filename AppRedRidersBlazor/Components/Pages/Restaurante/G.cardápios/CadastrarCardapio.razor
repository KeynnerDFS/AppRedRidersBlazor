@page "/CadastrarCardapio"
@rendermode InteractiveServer
@using AppRedRidersBlazor.Models;
@inject CardapioDAO cardapioDAO;
@inject NavigationManager Navigation;

<PageTitle>Novo Cardápio</PageTitle>

<main>
    <div id="container-login">
        <EditForm Model="_novoCardapio" OnValidSubmit="Salvar">
            <h2>Novo Cardápio</h2>

            <div class="container-form-login">
                <label for="Cardapio-name">Nome:</label><br />
                <InputText @bind-Value="_novoCardapio!.nome" name="nome" placeholder="Nome..." class="form-control" />
                <br />

                <label for="Cardapio-Descricao">Descrição:</label><br />
                <InputTextArea @bind-Value="_novoCardapio!.descricao" name="Cardapio-Descricao" id="Cardapio-Descricao" cols="30" rows="10" class="form-control" />
            </div>

            <button type="submit" class="btn-salvar">Cadastrar</button>

            @if (erro is not null)
            {
                <p style="color:red">@erro</p>
            }
        </EditForm>
    </div>

</main>
@code{
    private string? erro = null;

    [SupplyParameterFromForm]
    private Cardapio? _novoCardapio { get; set; } = new();

    private void Salvar()
    {

        try
        {
            if (_novoCardapio.nome is null || _novoCardapio.nome == "")
            {
                throw new Exception("O campo nome é obrigatório");
            }

            cardapioDAO.Inserir(_novoCardapio);

            Navigation.NavigateTo("/MainRestaurante");
        }
        catch (Exception ex)
        {
            erro = ex.Message;
        }


    }
}